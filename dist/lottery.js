!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Lottery=e()}(this,function(){"use strict";Object.assign=Object.assign||function(t){if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),i=1;i<arguments.length;i++){var n=arguments[i];if(void 0!==n&&null!==n)for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])}return e};var t=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},e=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},n=function(){function e(){t(this,e),this._queue=[]}return e.prototype.on=function(t,e){return this._queue[t]=this._queue[t]||[],this._queue[t].push(e),this},e.prototype.off=function(t,e){if(this._queue[t]){var i="undefined"==typeof e?-2:this._queue[t].indexOf(e);i===-2?delete this._queue[t]:i!==-1&&this._queue[t].splice(i,1),this._queue[t]&&0==this._queue[t].length&&delete this._queue[t]}return this},e.prototype.has=function(t){return!!this._queue[t]},e.prototype.trigger=function(t){if(this._queue[t]){for(var e=arguments.length,i=Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];for(var o=this._queue[t],s=Array.isArray(o),r=0,o=s?o:o[Symbol.iterator]();;){var a;if(s){if(r>=o.length)break;a=o[r++]}else{if(r=o.next(),r.done)break;a=r.value}var h=a;h.apply(this,i)}}return this},e}(),o=function(n){function o(e,s){t(this,o);var r=i(this,n.call(this));return r.options=Object.assign({size:20,percent:50,resize:!0,cover:null},s),r.canvas=e,r.ctx=e.getContext("2d"),r._first=!0,r._touch=!1,r.init(),r.bind(),r}return e(o,n),o.prototype.getCanvasInfo=function(){var t=this.canvas.getBoundingClientRect(),e=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,i=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeftp||0;this.width=t.width,this.height=t.height,this.offsetX=Math.round(t.left+i),this.offsetY=Math.round(t.top+e),this.canvas.width=t.width,this.canvas.height=t.height},o.prototype.bind=function(){var t="ontouchstart"in window&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent);this.canvas.addEventListener(t?"touchstart":"mousedown",this.onTouchStart.bind(this),!1),this.canvas.addEventListener(t?"touchmove":"mousemove",this.onTouchMove.bind(this),!1),document.addEventListener(t?"touchend":"mouseup",this.onTouchEnd.bind(this)),window.addEventListener("onorientationchange"in document?"orientationchange":"resize",this.onResize.bind(this))},o.prototype.init=function(){this._state="init",this.getCanvasInfo(),this.ctx.closePath(),this.ctx.globalCompositeOperation="source-over";var t=this.options.cover;t instanceof Image?(this.ctx.fillStyle=this.ctx.createPattern(t,"repeat"),this.ctx.rect(0,0,this.width,this.height)):(this.ctx.fillStyle="string"==typeof t?t:"gray",this.ctx.fillRect(0,0,this.width,this.height)),this.ctx.fill(),this.ctx.globalCompositeOperation="destination-out"},o.prototype.reset=function(){this._first=!0,this._touch=!1,this.canvas.style.backgroundImage=null,this.init(),this.trigger("reset")},o.prototype.setResult=function(t){this.canvas.style.backgroundImage="url("+t+")"},o.prototype.draw=function(){"end"!==this._state&&(this._state="end",this.ctx.clearRect(0,0,this.width,this.height),this.trigger("end"))},o.prototype.scratchPercent=function(){for(var t=0,e=this.ctx.getImageData(0,0,this.width,this.height),i=0,n=e.data.length;i<n;i+=4)0===e.data[i]&&0===e.data[i+1]&&0===e.data[i+2]&&0===e.data[i+3]&&t++;return t/(this.width*this.height)*100},o.prototype.getEventXY=function(t){return t=t.changedTouches?t.changedTouches[0]:t,{x:t.pageX-this.offsetX,y:t.pageY-this.offsetY}},o.prototype.onTouchStart=function(t){var e=this;if(t.preventDefault(),"end"!=this._state){var i=function(){var i=e.getEventXY(t);e._state="start",e._touch=!0,e._first=!1,e.ctx.beginPath(),e.ctx.arc(i.x,i.y,e.options.size/2,0,2*Math.PI,!0),e.ctx.closePath(),e.ctx.fill(),e.ctx.beginPath(),e.ctx.lineWidth=e.options.size,e.ctx.moveTo(i.x,i.y)};this.has("start")&&this._first?this.trigger("start",i):i()}},o.prototype.onTouchMove=function(t){if(t.preventDefault(),this._touch){var e=this.getEventXY(t);this.ctx.lineTo(e.x,e.y),this.ctx.stroke()}},o.prototype.onTouchEnd=function(t){if(this._touch){this._touch=!1;var e=this.getEventXY(t);this.ctx.closePath(),this.ctx.beginPath(),this.ctx.arc(e.x,e.y,this.options.size/2,0,2*Math.PI,!0),this.ctx.closePath(),this.ctx.fill(),this.scratchPercent()>=this.options.percent&&(this.ctx.clearRect(0,0,this.width,this.height),this._state="end",this.trigger("end"))}},o.prototype.onResize=function(){this._touch=!1,this.options.resize&&"end"!==this._state?this.init():this.getCanvasInfo()},o}(n),s=function(t,e,i){function n(t){return t.replace(/-([a-z])/gi,function(t,e){return e.toUpperCase()})}if(void 0===t.style[e])for(var o=["webkit","ms","moz","o"],s=0;s<o.length;s++){var r=o[s];if(e=n(r+"-"+e),void 0!==t.style[e])break}return t.style[e]=i,e},r=0,a=window.requestAnimationFrame||window.msRequestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame||function(t){var e=(new Date).getTime(),i=Math.max(0,16-(e-r)),n=window.setTimeout(function(){t(e+i)},i);return r=e+i,n},h=window.cancelAnimationFrame||window.msCancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.oCancelAnimationFrame||function(t){clearInterval(t)},c=function(n){function o(e,s){t(this,o);var r=i(this,n.call(this));return r.options=Object.assign({speed:30,areaNumber:8},s),r.pointer=e,r.init(),r}return e(o,n),o.prototype.init=function(){this._transform=s(this.pointer,"transform","translate3d(0,0,0)"),s(this.pointer,"backfaceVisibility","hidden"),s(this.pointer,"perspective","1000px"),this._raf=null,this._runAngle=0,this._targetAngle=-1},o.prototype.reset=function(){var t=arguments.length<=0||void 0===arguments[0]?"reset":arguments[0];this._raf&&(h(this._raf),this._raf=null,this._runAngle=0,this._targetAngle=-1,this.trigger(t),"reset"==t&&s(this.pointer,this._transform,"translate3d(0,0,0) rotate(0deg)"))},o.prototype.setResult=function(t){var e=360/this.options.areaNumber,i=Math.ceil(Math.random()*e+t*e);this._runAngle=0,this._targetAngle=i+360*(Math.floor(4*Math.random())+4)},o.prototype.draw=function(){var t=this;if(!this._raf){var e=function(){var e=0,i=function(){t._targetAngle==-1?t._runAngle+=t.options.speed:(e=(t._targetAngle-t._runAngle)/t.options.speed,e=e>t.options.speed?t.options.speed:e<.5?.5:e,t._runAngle+=e,t._runAngle=t._runAngle>t._targetAngle?t._targetAngle:t._runAngle),s(t.pointer,t._transform,"translate3d(0,0,0) rotate("+t._runAngle%360+"deg)"),t._runAngle==t._targetAngle?t.reset("end"):t._raf=a(i)};t._raf=a(i)};this.has("start")?this.trigger("start",e):e()}},o}(n),u=function(){var t=document.createElement("div"),e={animation:"animationend",webkitAnimation:"webkitAnimationEnd",msAnimation:"MSAnimationEnd",oAnimation:"oanimationend"};for(var i in e)if(void 0!==t.style[i])return e[i];return null}(),l=function(t,e){function i(){e(),t.removeEventListener(u,i)}var n=arguments.length<=2||void 0===arguments[2]?0:arguments[2];u?t.addEventListener(u,i):setTimeout(e,n)},f=function(){function e(i,n){var o=this;t(this,e),this.elem=i,this.items=i.children,this.height=this.items[0].clientHeight,this.elem.appendChild(this.items[0].cloneNode(!0)),n&&window.addEventListener("onorientationchange"in document?"orientationchange":"resize",function(){o.height=o.items[0].clientHeight,o.elem.classList.contains("fx-roll")||(o.elem.style.marginTop=-o.index*o.height+"px")})}return e.prototype.reset=function(){this.elem.classList.remove("fx-roll"),this.elem.classList.remove("fx-bounce"),this.elem.style.marginTop=0,this.state=0},e.prototype.start=function(){var t=this,e=arguments.length<=0||void 0===arguments[0]?0:arguments[0];1!==this.state&&(this.state=1,setTimeout(function(){1==t.state&&(t.elem.classList.add("fx-roll"),t.elem.style.marginTop=0)},e))},e.prototype.stop=function(t,e){var i=this,n=arguments.length<=2||void 0===arguments[2]?0:arguments[2];setTimeout(function(){1==i.state&&(i.elem.classList.remove("fx-roll"),i.elem.classList.add("fx-bounce"),i.elem.style.marginTop=-t*i.height+"px",l(i.elem,function(){i.state=0,i.elem.classList.remove("fx-bounce"),e&&e.call(i,t)}))},n)},e}(),d=function(n){function o(e,s,r){t(this,o);var a=i(this,n.call(this));a.options=Object.assign({interval:300,aniMinTime:6e3,resize:!0},r),a.toggle=e,a.rollerQueue=[];for(var h=0;h<s.length;h++)a.rollerQueue.push(new f(s[h],a.options.resize));return a}return e(o,n),o.prototype.reset=function(){this.toggle.classList.remove("z-active");for(var t=0,e=this.rollerQueue.length;t<e;t++)this.rollerQueue[t].reset();this.trigger("reset")},o.prototype.setResult=function(t){var e=this,i=(new Date).getTime();setTimeout(function(){for(var i=0,n=e.rollerQueue.length;i<n;i++)e.rollerQueue[i].stop(t[i],i==n-1?function(){e.toggle.classList.remove("z-active"),e.trigger("end")}:null,i*e.options.interval)},i-this._startTime>this.options.aniMinTime?0:this.options.aniMinTime-(i-this._startTime))},o.prototype.draw=function(){var t=this;if(!this.toggle.classList.contains("z-active")){var e=function(){t.toggle.classList.add("z-active");for(var e=0,i=t.rollerQueue.length;e<i;e++)t.rollerQueue[e].start(e*t.options.interval)};this._startTime=(new Date).getTime(),this.has("start")?this.trigger("start",e):e()}},o}(n),p={Card:o,Dial:c,Tiger:d};return p});